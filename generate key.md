–°—É–¥—è –ø–æ –∫–æ–¥—É, —ç—Ç–∏ –∫–ª—é—á–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π **—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–ª—é—á–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JWK (JSON Web Key)**, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è JWT —Ç–æ–∫–µ–Ω–æ–≤.

## –û—Ç–∫—É–¥–∞ –≤–∑—è–ª–∏—Å—å —ç—Ç–∏ –∫–ª—é—á–∏?

–ê–≤—Ç–æ—Ä –∫–æ–¥–∞ **—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª –∏—Ö —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ**. –≠—Ç–∏ –∫–ª—é—á–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JWK –æ–∫—Ç–µ—Ç–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (`"kty":"oct"`), –≥–¥–µ:

- **`access-token-key`** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ JWT —Ç–æ–∫–µ–Ω–æ–≤ –¥–æ—Å—Ç—É–ø–∞ (JWS - JSON Web Signature) —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º HMAC
- **`refresh-token-key`** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è refresh —Ç–æ–∫–µ–Ω–æ–≤ (JWE - JSON Web Encryption) —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º Direct Encryption

## –ö–∞–∫ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∫–ª—é—á–∏?

–í—ã –º–æ–∂–µ—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–æ–±–Ω—ã–µ –∫–ª—é—á–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏:

### 1. –° –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Nimbus JOSE JWT (–∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ):

```java
import com.nimbusds.jose.jwk.OctetSequenceKey;
import com.nimbusds.jose.jwk.gen.OctetSequenceKeyGenerator;

// –î–ª—è access token (256 –±–∏—Ç –¥–ª—è HS256)
OctetSequenceKey accessKey = new OctetSequenceKeyGenerator(256).generate();
System.out.println(accessKey.toJSONString());

// –î–ª—è refresh token (128 –±–∏—Ç –¥–ª—è AES)
OctetSequenceKey refreshKey = new OctetSequenceKeyGenerator(128).generate();
System.out.println(refreshKey.toJSONString());
```


### 2. –û–Ω–ª–∞–π–Ω-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã JWK

–°—É—â–µ—Å—Ç–≤—É—é—Ç –æ–Ω–ª–∞–π–Ω-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ JWK –∫–ª—é—á–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, mkjwk.org)

## ‚ö†Ô∏è –í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–≠—Ç–∏ –∫–ª—é—á–∏ —è–≤–Ω–æ **–ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏/—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** (sandbox –ø—Ä–æ–µ–∫—Ç). –í production-–æ–∫—Ä—É–∂–µ–Ω–∏–∏:

- ‚ùå **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –≤ —Ñ–∞–π–ª–∞—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, —Å–µ–∫—Ä–µ—Ç—ã Kubernetes, HashiCorp Vault –∏ —Ç.–ø.
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –º–µ–Ω—è–π—Ç–µ –∫–ª—é—á–∏ (key rotation)

# —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±–∞ –∫–ª—é—á–∞ –Ω–∞ **mkjwk.org**.

## üîë 1. Access Token Key (–¥–ª—è –ø–æ–¥–ø–∏—Å–∏ JWS)

–≠—Ç–æ—Ç –∫–ª—é—á –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **HMAC-–ø–æ–¥–ø–∏—Å–∏** —Ç–æ–∫–µ–Ω–æ–≤ –¥–æ—Å—Ç—É–ø–∞.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ mkjwk.org:

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ü–æ—è—Å–Ω–µ–Ω–∏–µ |
|------|----------|-----------|
| **Key Type** | `oct` (Octet sequence) | –°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –∫–ª—é—á |
| **Key Size** | `256` | 256 –±–∏—Ç –¥–ª—è HS256 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä) |
| **Key Use** | `Signature` | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ |
| **Algorithm** | `HS256` | HMAC SHA-256 |
| **Key ID** | –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º –∏–ª–∏ –∑–∞–¥–∞—Ç—å –ª—é–±–æ–π | –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –≤–∞—à–µ–≥–æ —Å–ª—É—á–∞—è |

### –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:
```json
{
  "kty": "oct",
  "k": "—Å–ª—É—á–∞–π–Ω–∞—è_base64url_—Å—Ç—Ä–æ–∫–∞"
}
```


---

## üîê 2. Refresh Token Key (–¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è JWE)

–≠—Ç–æ—Ç –∫–ª—é—á –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è** refresh —Ç–æ–∫–µ–Ω–æ–≤ (Direct Encryption).

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ mkjwk.org:

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ü–æ—è—Å–Ω–µ–Ω–∏–µ |
|------|----------|-----------|
| **Key Type** | `oct` (Octet sequence) | –°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –∫–ª—é—á |
| **Key Size** | `128` | 128 –±–∏—Ç –¥–ª—è AES (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è Direct) |
| **Key Use** | `Encryption` | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è |
| **Algorithm** | `dir` | Direct encryption (–∫–ª—é—á –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é) |
| **Key ID** | –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º –∏–ª–∏ –∑–∞–¥–∞—Ç—å –ª—é–±–æ–π | –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –≤–∞—à–µ–≥–æ —Å–ª—É—á–∞—è |

### –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:
```json
{
  "kty": "oct",
  "k": "–∫–æ—Ä–æ—Ç–∫–∞—è_base64url_—Å—Ç—Ä–æ–∫–∞"
}
```


---

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ **mkjwk.org**
2. **–î–ª—è Access Token Key:**
    - Tab: `oct`
    - Key Size: `256`
    - Key Use: `Signature`
    - Algorithm: `HS256`
    - –ù–∞–∂–º–∏—Ç–µ **Generate**
    - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ JSON (—Ç–æ–ª—å–∫–æ `{"kty":"oct","k":"..."}`)

3. **–î–ª—è Refresh Token Key:**
    - Tab: `oct`
    - Key Size: `128`
    - Key Use: `Encryption`
    - Algorithm: `dir`
    - –ù–∞–∂–º–∏—Ç–µ **Generate**
    - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ JSON (—Ç–æ–ª—å–∫–æ `{"kty":"oct","k":"..."}`)

4. –í—Å—Ç–∞–≤—å—Ç–µ –≤ –≤–∞—à `application.yml`:

```yaml
jwt:
  access-token-key: '{"kty":"oct","k":"–≤–∞—à_–Ω–æ–≤—ã–π_256bit_–∫–ª—é—á"}'
  refresh-token-key: '{"kty":"oct","k":"–≤–∞—à_–Ω–æ–≤—ã–π_128bit_–∫–ª—é—á"}'
```


---

## üí° –ü–æ—á–µ–º—É —Ç–∞–∫–∏–µ —Ä–∞–∑–º–µ—Ä—ã?

- **256 –±–∏—Ç** –¥–ª—è access token ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è HS256 (HMAC-SHA256)
- **128 –±–∏—Ç** –¥–ª—è refresh token ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è AES —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å Direct –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∫–ª—é—á –¥–ª—è refresh —Ç–æ–∫–µ–Ω–∞ –∫–æ—Ä–æ—á–µ (–º–µ–Ω—å—à–µ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∑–Ω–∞—á–µ–Ω–∏–∏ `k`), —á–µ–º –¥–ª—è access —Ç–æ–∫–µ–Ω–∞.